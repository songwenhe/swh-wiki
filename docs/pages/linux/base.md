---
title: linux 基础知识
order: 1
---

# Linux 基础

## Linux 目录结构

- **/bin**：
  bin 是 Binaries (二进制文件) 的缩写, 这个目录存放着最经常使用的命令。

- **/boot：**
  这里存放的是启动 Linux 时使用的一些核心文件，包括一些连接文件以及镜像文件。

- **/dev ：**
  dev 是 Device(设备) 的缩写, 该目录下存放的是 Linux 的外部设备，在 Linux 中访问设备的方式和访问文件的方式是相同的。

- **/etc：**
  etc 是 Etcetera(等等) 的缩写,这个目录用来存放所有的系统管理所需要的配置文件和子目录。

- **/home**：
  用户的主目录，在 Linux 中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的，如上图中的 alice、bob 和 eve。

- **/lib**：
  lib 是 Library(库) 的缩写这个目录里存放着系统最基本的动态连接共享库，其作用类似于 Windows 里的 DLL 文件。几乎所有的应用程序都需要用到这些共享库。

- **/lost+found**：
  这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。

- **/media**：
  linux 系统会自动识别一些设备，例如 U 盘、光驱等等，当识别后，Linux 会把识别的设备挂载到这个目录下。

- **/mnt**：
  系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在 /mnt/ 上，然后进入该目录就可以查看光驱里的内容了。

- **/opt**：
  opt 是 optional(可选) 的缩写，这是给主机额外安装软件所摆放的目录。比如你安装一个 ORACLE 数据库则就可以放到这个目录下。默认是空的。

- **/proc**：
  proc 是 Processes(进程) 的缩写，/proc 是一种伪文件系统（也即虚拟文件系统），存储的是当前内核运行状态的一系列特殊文件，这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。
  这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的 ping 命令，使别人无法 ping 你的机器：

  ```shell
  echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all
  ```

- **/root**：
  该目录为系统管理员，也称作超级权限者的用户主目录。

- **/sbin**：
  s 就是 Super User 的意思，是 Superuser Binaries (超级用户的二进制文件) 的缩写，这里存放的是系统管理员使用的系统管理程序。

- **/selinux**：
  这个目录是 Redhat/CentOS 所特有的目录，Selinux 是一个安全机制，类似于 windows 的防火墙，但是这套机制比较复杂，这个目录就是存放 selinux 相关的文件的。

- **/srv**：
  该目录存放一些服务启动之后需要提取的数据。

- **/sys**：

  这是 Linux2.6 内核的一个很大的变化。该目录下安装了 2.6 内核中新出现的一个文件系统 sysfs 。

  sysfs 文件系统集成了下面 3 种文件系统的信息：针对进程信息的 proc 文件系统、针对设备的 devfs 文件系统以及针对伪终端的 devpts 文件系统。

  该文件系统是内核设备树的一个直观反映。

  当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。

- **/tmp**：
  tmp 是 temporary(临时) 的缩写这个目录是用来存放一些临时文件的。

- **/usr**：
  usr 是 unix shared resources(共享资源) 的缩写，这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于 windows 下的 program files 目录。

- **/usr/bin：**
  系统用户使用的应用程序。

- **/usr/sbin：**
  超级用户使用的比较高级的管理程序和系统守护程序。

- **/usr/src：**
  内核源代码默认的放置目录。

- **/var**：
  var 是 variable(变量) 的缩写，这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。

- **/run**：
  是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除。如果你的系统上有 /var/run 目录，应该让它指向 run。

在 Linux 系统中，有几个目录是比较重要的，平时需要注意不要误删除或者随意更改内部文件。

**/etc**： 上边也提到了，这个是系统中的配置文件，如果你更改了该目录下的某个文件可能会导致系统不能启动。

**/bin, /sbin, /usr/bin, /usr/sbin**: 这是系统预设的执行文件的放置目录，比如 **ls** 就是在 **/bin/ls** 目录下的。

值得提出的是 **/bin**、**/usr/bin** 是给系统用户使用的指令（除 root 外的通用用户），而/sbin, /usr/sbin 则是给 root 使用的指令。

**/var**： 这是一个非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在 /var/log 目录下，另外 mail 的预设放置也是在这里。

## Linux 忘记密码解决方法

进入单用户模式更改一下 root 密码即可。

## Linux 包管理

### yum 命令

#### yum 语法（centos）

```shell
yum [options] [command] [package ...]
```

- **options：**可选，选项包括-h（帮助），-y（当安装过程提示选择全部为 "yes"），-q（不显示安装的过程）等等。
- **command：**要进行的操作。
- **package：**安装的包名。

---

#### yum 常用命令

| yum check-update                                                      | 列出所有可更新的软件清单命令         |
| --------------------------------------------------------------------- | ------------------------------------ |
| yum update                                                            | 更新所有软件命令                     |
| `yum install <package_name>`                                          | 仅安装指定的软件命令                 |
| `yum update <package_name>`                                           | 仅更新指定的软件命令                 |
| yum list                                                              | 列出所有可安裝的软件清单命令         |
| `yum remove <package_name>`                                           | 删除软件包命令                       |
| `yum search <keyword>`                                                | 查找软件包命令                       |
| yum clean packages                                                    | 清除缓存目录下的软件包               |
| yum clean headers                                                     | 清除缓存目录下的 headers             |
| yum clean oldheaders                                                  | 清除缓存目录下旧的 headers           |
| yum clean, yum clean all (= yum clean packages; yum clean oldheaders) | 清除缓存目录下的软件包及旧的 headers |

### apt 命令

#### apt 语法

```shell
  apt [options] [command] [package ...]
```

- **options：**可选，选项包括 -h（帮助），-y（当安装过程提示选择全部为"yes"），-q（不显示安装的过程）等等。
- **command：**要进行的操作。
- **package**：安装的包名。

#### apt 常用命令

| sudo apt update                                        | 列出所有可更新的软件清单命令                            |
| :----------------------------------------------------- | ------------------------------------------------------- |
| sudo apt upgrade                                       | 升级软件包                                              |
| apt list --upgradeable                                 | 列出可更新的软件包及版本信息                            |
| sudo apt full-upgrade                                  | 升级软件包，升级前先删除需要更新软件包                  |
| `sudo apt install <package_name>`                      | 安装指定的软件命令                                      |
| `sudo apt install <package_1> <package_2> <package_3>` | 安装多个软件包                                          |
| `sudo apt install <package_name>`                      | 更新指定的软件命令                                      |
| `sudo apt show <package_name>`                         | 显示软件包具体信息,例如：版本号，安装大小，依赖关系等等 |
| `sudo apt remove <package_name>`                       | 删除软件包命令                                          |
| sudo apt autoremove                                    | 清理不再使用的依赖和库文件                              |
| `sudo apt purge <package_name>`                        | 移除软件包及配置文件                                    |
| `sudo apt search <package_name>`                       | 查找软件包命令                                          |
| apt list --installed                                   | 列出所有已安装的包                                      |
| apt list --all-versions                                | 列出所有已安装的包的版本信息                            |

## Linux 用户和用户组管理

### 用户管理

#### 添加新的用户账号

使用 useradd 命令，其语法如下：

```shell
useradd 选项 用户名
```

参数说明：

选项:

| -c  | comment 指定一段注释性描述。                                                 |
| :-: | ---------------------------------------------------------------------------- |
| -d  | 目录 指定用户主目录，如果此目录不存在，则同时使用-m 选项，可以创建主目录。   |
| -g  | 用户组 指定用户所属的用户组。                                                |
| -G  | 用户组，用户组 指定用户所属的附加组。                                        |
| -s  | Shell 文件 指定用户的登录 Shell。                                            |
| -u  | 用户号 指定用户的用户号，如果同时有-o 选项，则可以重复使用其他用户的标识号。 |

用户名: 指定新账号的登录名。

#### 删除账号

删除一个已有的用户账号使用`userdel`命令，其格式如下：

```shell
userdel 选项 用户名
```

常用的选项是 **-r**，它的作用是把用户的主目录一起删除。

例如：

```shell
userdel -r sam
```

此命令删除用户 sam 在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group 等）的记录，同时删除用户的主目录。

#### 修改帐号

修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录 Shell 等。

修改已有用户的信息使用`usermod`命令，其格式如下：

```shell
usermod 选项 用户名
```

常用的选项包括`-c, -d, -m, -g, -G, -s, -u以及-o等`，这些选项的意义与`useradd`命令中的选项一样，可以为用户指定新的资源值。

另外，有些系统可以使用选项：-l 新用户名

这个选项指定一个新的账号，即将原来的用户名改为新的用户名。

例如：

```shell
usermod -s /bin/ksh -d /home/z –g developer sam
```

此命令将用户 sam 的登录 Shell 修改为 ksh，主目录改为/home/z，用户组改为 developer。

#### 用户口令的管理

指定和修改用户口令的 Shell 命令是`passwd`。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：

```shell
passwd 选项 用户名
```

可使用的选项：

- -l 锁定口令，即禁用账号。
- -u 口令解锁。
- -d 使账号无口令。
- -f 强迫用户下次登录时修改口令。

如果默认用户名，则修改当前用户的口令。

例如，假设当前用户是 sam，则下面的命令修改该用户自己的口令：

```shell
$ passwd
Old password:******
New password:*******
Re-enter new password:*******
```

如果是超级用户，可以用下列形式指定任何用户的口令：

```shell
$ passwd sam
New password:*******
Re-enter new password:*******
```

### 用户组管理

#### 新增组

```shell
groupadd 组名
```

#### 删除组

```shell
groupdel 组名
```

#### 修改用户的组

```shell
usermod -g 用户组 用户名
```

## Linux vi/vim

### vi/vim 的使用

基本上 vi/vim 共分为三种模式，分别是命令模式（Command mode），输入模式（Insert mode）和底线命令模式（Last line mode）。 这三种模式的作用分别

是：

#### 命令模式：

用户刚刚启动 vi/vim，便进入了命令模式。

此状态下敲击键盘动作会被 Vim 识别为命令，而非输入字符。比如我们此时按下 i，并不会输入一个字符，i 被当作了一个命令。

以下是常用的几个命令：

- **i** 切换到输入模式，以输入字符。
- **x** 删除当前光标所在处的字符。
- **:** 切换到底线命令模式，以在最底一行输入命令。

若想要编辑文本：启动 Vim，进入了命令模式，按下 i，切换到输入模式。

命令模式只有一些最基本的命令，因此仍要依靠底线命令模式输入更多命令。

#### 输入模式

在命令模式下按下 i 就进入了输入模式。

在输入模式中，可以使用以下按键：

- **字符按键以及 Shift 组合**，输入字符
- **ENTER**，回车键，换行
- **BACK SPACE**，退格键，删除光标前一个字符
- **DEL**，删除键，删除光标后一个字符
- **方向键**，在文本中移动光标
- **HOME**/**END**，移动光标到行首/行尾
- **Page Up**/**Page Down**，上/下翻页
- **Insert**，切换光标为输入/替换模式，光标将变成竖线/下划线
- **ESC**，退出输入模式，切换到命令模式

#### 底线命令模式

在命令模式下按下:（英文冒号）就进入了底线命令模式。

底线命令模式可以输入单个或多个字符的命令，可用的命令非常多。

在底线命令模式中，基本的命令有（已经省略了冒号）：

- q 退出程序
- w 保存文件

按 ESC 键可随时退出底线命令模式。

## 关机&重启命令

| shutdown -h 1 | 1 分钟后关机 ，-h 设置多久关机，单位为分           |
| ------------- | -------------------------------------------------- |
| halt          | 关机                                               |
| reboot        | 重启                                               |
| sync          | 把内存数据同步到磁盘，在关机和重启要运行 sync 命令 |

## 用户登录和注销

su - 用户名 ：却换用户

logout：注销用户

## 运行级别

基本介绍

| 0   | 关机                   |
| --- | ---------------------- |
| 1   | 单用户【找回丢失密码】 |
| 2   | 多用户状态没有网络服务 |
| 3   | 多用户状态有网络服务   |
| 4   | 系统未使用保留给用户   |
| 5   | 图形界面               |
| 6   | 系统重启               |

## 定时任务

```shell
crontab [options]
```

-e：执行文字编辑器来设定时程表，可以用 select-editor 来选择编辑工具

-r：删除目前的时程表

-l：列出目前的时程表

```text
*    *    *    *    *
-    -    -    -    -
|    |    |    |    |
|    |    |    |    +----- 星期中星期几 (0 - 6) (星期天 为0)
|    |    |    +---------- 月份 (1 - 12)
|    |    +--------------- 一个月中的第几天 (1 - 31)
|    +-------------------- 小时 (0 - 23)
+------------------------- 分钟 (0 - 59)
```
